#include <gtest/gtest.h>
#include "hippomocks.h"
using namespace std;
 
class File
{
};
 
class Source
{
public:
  virtual File* getData() = 0;
};
 
class Destination
{
public:
  virtual void write(File* data) = 0;
};
 
class CopyOperation
{
public:
  void Perform(
    Source* source,
    Destination* destination)
  {
    destination->write(source->getData());
  }
};
 
TEST(CopyOperationSpecification,
    ShouldCopyFileFromSourceToDestination)
{
  MockRepository mocks;
  auto source = mocks.InterfaceMock<Source>();
  auto destination = mocks.InterfaceMock<Destination>();
  auto file = mocks.Mock<File>();
  CopyOperation copy;
 
  mocks.ExpectCall(source, Source::getData).Return(file);
  mocks.ExpectCall(destination, Destination::write).With(file);
 
  copy.Perform(source, destination);
}